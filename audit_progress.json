{
  "auditDate": "2026-01-08",
  "auditVersion": "1.1",
  "stackFile": "infrastructure/lib/pivotr-mailer-stack.ts",
  "components": {
    "dynamodb": {
      "status": "compliant",
      "tables": {
        "LeadsTable": {
          "removalPolicy": "RETAIN",
          "pointInTimeRecovery": true,
          "status": "compliant"
        },
        "CampaignsTable": {
          "removalPolicy": "RETAIN",
          "pointInTimeRecovery": true,
          "status": "fixed",
          "fix": "Added pointInTimeRecovery: true"
        },
        "MetricsTable": {
          "removalPolicy": "RETAIN",
          "pointInTimeRecovery": true,
          "status": "fixed",
          "fix": "Added pointInTimeRecovery: true"
        },
        "LogsTable": {
          "removalPolicy": "RETAIN",
          "pointInTimeRecovery": true,
          "status": "fixed",
          "fix": "Added pointInTimeRecovery: true"
        },
        "SettingsTable": {
          "removalPolicy": "RETAIN",
          "pointInTimeRecovery": true,
          "status": "fixed",
          "fix": "Added pointInTimeRecovery: true"
        }
      }
    },
    "lambda": {
      "status": "compliant",
      "functions": {
        "ProcessFeedbackLambda": {
          "reservedConcurrency": 10,
          "timeout": "10s",
          "memory": 128,
          "logRetention": "ONE_MONTH",
          "status": "fixed",
          "fixes": ["Added logRetention: ONE_MONTH", "Removed invalid events property"]
        },
        "SendEmailLambda": {
          "reservedConcurrency": 5,
          "timeout": "30s",
          "memory": 256,
          "logRetention": "ONE_MONTH",
          "status": "fixed",
          "fix": "Added logRetention: ONE_MONTH"
        },
        "VerifyEmailLambda": {
          "reservedConcurrency": 3,
          "timeout": "15s",
          "memory": 256,
          "logRetention": "ONE_MONTH",
          "status": "fixed",
          "fix": "Added logRetention: ONE_MONTH"
        },
        "LeadImportLambda": {
          "reservedConcurrency": 2,
          "timeout": "60s",
          "memory": 512,
          "logRetention": "ONE_MONTH",
          "status": "fixed",
          "fix": "Added logRetention: ONE_MONTH"
        },
        "ApiLeadsLambda": {
          "reservedConcurrency": 10,
          "timeout": "10s",
          "memory": 256,
          "logRetention": "ONE_MONTH",
          "status": "fixed",
          "fix": "Added logRetention: ONE_MONTH"
        },
        "ApiCampaignsLambda": {
          "reservedConcurrency": 10,
          "timeout": "10s",
          "memory": 256,
          "logRetention": "ONE_MONTH",
          "status": "fixed",
          "fix": "Added logRetention: ONE_MONTH"
        },
        "ApiMetricsLambda": {
          "reservedConcurrency": 10,
          "timeout": "10s",
          "memory": 256,
          "logRetention": "ONE_MONTH",
          "status": "fixed",
          "fix": "Added logRetention: ONE_MONTH"
        },
        "ApiLeadsExportLambda": {
          "reservedConcurrency": 5,
          "timeout": "20s",
          "memory": 1024,
          "logRetention": "ONE_MONTH",
          "status": "fixed",
          "fix": "Added logRetention: ONE_MONTH"
        }
      }
    },
    "sqs": {
      "status": "compliant",
      "queues": {
        "SendingQueue": {
          "dlq": "SendingDLQ",
          "maxReceiveCount": 3,
          "visibilityTimeout": "35s",
          "status": "compliant"
        },
        "FeedbackQueue": {
          "dlq": "FeedbackDLQ",
          "maxReceiveCount": 5,
          "visibilityTimeout": "15s",
          "snsSubscription": "SESFeedbackTopic",
          "status": "compliant"
        },
        "VerificationQueue": {
          "dlq": "VerificationDLQ",
          "maxReceiveCount": 2,
          "visibilityTimeout": "20s",
          "status": "compliant"
        }
      }
    },
    "sns": {
      "status": "compliant",
      "topics": {
        "AlarmTopic": {
          "purpose": "CloudWatch alarm notifications",
          "status": "compliant"
        },
        "SESFeedbackTopic": {
          "purpose": "SES bounce/complaint/delivery notifications",
          "status": "fixed",
          "fix": "Created new SNS topic with SQS subscription to FeedbackQueue"
        }
      }
    },
    "ses": {
      "status": "compliant",
      "resources": {
        "PivotrConfigSet": {
          "reputationMetrics": true,
          "sendingEnabled": true,
          "status": "fixed",
          "fix": "Created SES Configuration Set in CDK"
        },
        "SESEventDestination": {
          "events": ["BOUNCE", "COMPLAINT", "DELIVERY", "REJECT"],
          "destination": "SNS (SESFeedbackTopic)",
          "status": "fixed",
          "fix": "Created event destination linking SES to SNS topic"
        }
      }
    },
    "pipeline": {
      "sesSnsSqs": {
        "status": "compliant",
        "flow": "SES -> PivotrConfigSet -> SESEventDestination -> SESFeedbackTopic (SNS) -> FeedbackQueue (SQS) -> ProcessFeedbackLambda",
        "fix": "Complete pipeline now configured in CDK"
      }
    }
  },
  "summary": {
    "criticalIssuesResolved": [
      "SES -> SNS -> SQS pipeline now fully configured for email feedback",
      "All 5 DynamoDB tables now have Point-in-Time Recovery enabled",
      "All 8 Lambda functions now have logRetention set to ONE_MONTH"
    ],
    "totalIssuesFixed": 14,
    "remainingIssues": 0,
    "deprecationWarnings": [
      "pointInTimeRecovery should be migrated to pointInTimeRecoverySpecification",
      "logRetention should be migrated to logGroup"
    ]
  },
  "verificationStatus": {
    "typescriptCompile": "PASSED",
    "cdkSynth": "PASSED",
    "lastVerified": "2026-01-08"
  }
}
